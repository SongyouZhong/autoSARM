# autoSARM

**Automatic Structure-Activity Relationship Matrix Generator**

ä¸€ä¸ªç”¨äºè¯ç‰©åŒ–å­¦ç ”ç©¶çš„è‡ªåŠ¨åŒ–å·¥å…·ï¼Œä¸“é—¨ç”¨äºç”Ÿæˆå’Œåˆ†ææ„æ•ˆå…³ç³»ï¼ˆSARï¼‰è¡¨æ ¼å’Œåˆ†å­è¡ç”Ÿæ ‘ã€‚

[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)
[![RDKit](https://img.shields.io/badge/RDKit-Required-green.svg)](https://www.rdkit.org/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

---

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [å®‰è£…ä¾èµ–](#å®‰è£…ä¾èµ–)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ä½¿ç”¨è¯´æ˜](#ä½¿ç”¨è¯´æ˜)
- [åº”ç”¨åœºæ™¯](#åº”ç”¨åœºæ™¯)
- [ç¤ºä¾‹](#ç¤ºä¾‹)
- [æŠ€æœ¯ç‰¹ç‚¹](#æŠ€æœ¯ç‰¹ç‚¹)
- [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)
- [è®¸å¯è¯](#è®¸å¯è¯)

---

## ğŸ¯ é¡¹ç›®ç®€ä»‹

autoSARM æ˜¯ä¸€ä¸ªä¸“ä¸šçš„è¯ç‰©åŒ–å­¦è®¡ç®—å·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©è¯ç‰©åŒ–å­¦å®¶å’Œç ”ç©¶äººå‘˜å¿«é€Ÿåˆ†æå’Œå¯è§†åŒ–åŒ–åˆç‰©ç³»åˆ—çš„æ„æ•ˆå…³ç³»ã€‚é€šè¿‡è‡ªåŠ¨åŒ–çš„åˆ†å­ç‰‡æ®µåŒ–å’Œç»Ÿè®¡åˆ†æï¼Œè¯¥å·¥å…·èƒ½å¤Ÿï¼š

- ğŸ”¬ è‡ªåŠ¨è¯†åˆ«åˆ†å­æ ¸å¿ƒéª¨æ¶å’Œå–ä»£åŸº
- ğŸ“Š ç”Ÿæˆä¸€ç»´å’ŒäºŒç»´ SAR è¡¨æ ¼
- ğŸŒ³ æ„å»ºåˆ†å­è¡ç”Ÿå…³ç³»æ ‘
- ğŸ“ˆ å¯è§†åŒ–å±•ç¤ºæ„æ•ˆå…³ç³»æ¨¡å¼
- ğŸ’Š è¾…åŠ©å…ˆå¯¼åŒ–åˆç‰©ä¼˜åŒ–

è¯¥é¡¹ç›®ç‰¹åˆ«é€‚ç”¨äº**æ¿€é…¶æŠ‘åˆ¶å‰‚**ã€**GPCR é…ä½“**ç­‰ç³»åˆ—åŒ–åˆç‰©çš„ç ”å‘åˆ†æã€‚

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### 1. è‡ªåŠ¨åŒ–åˆ†å­ç‰‡æ®µåŒ–

- **æ™ºèƒ½åˆ‡å‰²ç®—æ³•**ï¼šåŸºäºåŒ–å­¦è§„åˆ™çš„åˆ†å­ç‰‡æ®µåŒ–
  - ç¯æ—è¾¹çš„å•é”®åˆ‡å‰²
  - ç¯-ç¯ä¹‹é—´çš„å•é”®åˆ‡å‰²
  - ä¸¤è½®è¿­ä»£ç‰‡æ®µåŒ–ç­–ç•¥
  
- **æ ¸å¿ƒç»“æ„è¯†åˆ«**ï¼š
  - Murcko scaffold æå–
  - è¯æ•ˆå›¢è¯†åˆ«
  - R åŸºå›¢è‡ªåŠ¨åˆ†ç±»

### 2. SAR è¡¨æ ¼ç”Ÿæˆ

#### **1D SAR è¡¨æ ¼**ï¼ˆå•ç‚¹å–ä»£åˆ†æï¼‰
- Left Tableï¼šå·¦ä¾§å–ä»£åŸºåˆ†æ
- Right Tableï¼šå³ä¾§å–ä»£åŸºåˆ†æ
- Single-cut Tableï¼šæ•´ä½“åˆ†å­æ¯”å¯¹

#### **2D SAR è¡¨æ ¼**ï¼ˆåŒç‚¹å–ä»£çŸ©é˜µï¼‰
- Combine Tableï¼šå®Œæ•´çš„äºŒç»´æ„æ•ˆå…³ç³»çŸ©é˜µ
- è‡ªåŠ¨åˆå¹¶å·¦å³è¡¨æ ¼
- æ™ºèƒ½å»é‡å’Œæ’åº

#### **ç»Ÿè®¡ä¿¡æ¯è‡ªåŠ¨è®¡ç®—**
- å‡å€¼ï¼ˆMeanï¼‰
- æ ‡å‡†å·®ï¼ˆStdï¼‰
- ä¸­ä½æ•°ï¼ˆMedianï¼‰
- æœ€å°å€¼/æœ€å¤§å€¼ï¼ˆMin/Maxï¼‰
- æ ·æœ¬æ•°é‡ï¼ˆCountï¼‰

### 3. SAR æ ‘å¯è§†åŒ–

- **å±‚çº§ç»“æ„å±•ç¤º**ï¼š
  - åŸºäºåˆ†å­ç›¸ä¼¼æ€§æ„å»ºæ ‘çŠ¶å›¾
  - å¯è‡ªå®šä¹‰æœ€å¤§å±‚çº§
  - æ”¯æŒåŒåˆ‡å‰²å’Œå•åˆ‡å‰²ç‰‡æ®µ

- **æ™ºèƒ½é«˜äº®**ï¼š
  - æ ¹æ®æ´»æ€§æ•°æ®é«˜äº®åŒ–åˆç‰©
  - æ”¯æŒå¤šé¶ç‚¹åŒæ—¶å±•ç¤º
  - è‡ªå®šä¹‰ç­›é€‰æ¡ä»¶

- **è¾“å‡ºæ ¼å¼**ï¼š
  - PDF é«˜è´¨é‡çŸ¢é‡å›¾
  - PNG åˆ†å­ç»“æ„å›¾
  - æ–‡æœ¬æ ‘çŠ¶ç»“æ„

### 4. åŸºäºæ ¸å¿ƒç»“æ„çš„ SAR åˆ†æ

- **å•æ ¸å¿ƒåˆ†æ**ï¼šé’ˆå¯¹ç‰¹å®šæ ¸å¿ƒç»“æ„ç”Ÿæˆ SAR è¡¨
- **R åŸºå›¢æšä¸¾**ï¼šè‡ªåŠ¨æå–æ‰€æœ‰å–ä»£ä½ç‚¹
- **Excel å¯è§†åŒ–æŠ¥å‘Š**ï¼šå¸¦åˆ†å­ç»“æ„å›¾çš„ Excel æ–‡ä»¶

### 5. 3D ç©ºé—´ä½ç½®åˆ†æï¼ˆå¯¹æ¥ç»“åˆåˆ†æï¼‰

- **å¯¹æ¥ç»“æœå¤„ç†**ï¼š
  - ä» SchrÃ¶dinger å¯¹æ¥ç»“æœï¼ˆmaegz æ ¼å¼ï¼‰æå– SDF æ–‡ä»¶
  - æ”¯æŒæŒ‰å¯¹æ¥è¯„åˆ†ç­›é€‰
  - æ‰¹é‡å¤„ç†å¤šä¸ªå¯¹æ¥æ„è±¡

- **åŸå­ä½ç½®ç½‘æ ¼åŒ–**ï¼š
  - 3D ç©ºé—´ç½‘æ ¼åˆ’åˆ†å’ŒåŸå­å¯†åº¦ç»Ÿè®¡
  - åŒºåˆ†ç¢³ã€æ°®ã€æ°§ç­‰åŸå­ç±»å‹
  - åŒºåˆ†èŠ³é¦™æ€§å’ŒéèŠ³é¦™æ€§åŸå­
  - ç¯çŠ¶åŸå­ç‰¹æ®Šæ ‡è®°

- **ç‰‡æ®µç©ºé—´ä½ç½®è¯„åˆ†**ï¼š
  - è®¡ç®—ç‰‡æ®µåœ¨ç»“åˆå£è¢‹ä¸­çš„ç©ºé—´å æ®
  - ç›¸å¯¹äºå‚è€ƒç‰‡æ®µçš„ä½ç½®è¯„åˆ†
  - è¾…åŠ©ç‰‡æ®µä¼˜åŒ–å’Œé€‰æ‹©

- **PyMOL å¯è§†åŒ–**ï¼š
  - ç”ŸæˆåŸå­å¯†åº¦çƒ­å›¾
  - å¤šç§é¢œè‰²æ–¹æ¡ˆï¼ˆæŒ‰åŸå­ç±»å‹ï¼‰
  - ç½‘æ ¼åŒ– 3D å¯è§†åŒ–

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
autoSARM/
â”œâ”€â”€ create_sarm.py              # ä¸»ç¨‹åºï¼šåˆ›å»º SAR è¡¨æ ¼
â”œâ”€â”€ create_tree.py              # ä¸»ç¨‹åºï¼šç”Ÿæˆ SAR æ ‘
â”œâ”€â”€ print_sar_single_core.py    # åŸºäºå•æ ¸å¿ƒç»“æ„ç”Ÿæˆ SARï¼ˆæ”¯æŒå¤šä¸ª R åŸºå›¢ï¼‰
â”œâ”€â”€ utils/                      # æ ¸å¿ƒå·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ sarm_utils.py          # SAR æ ¸å¿ƒç®—æ³•ï¼ˆç‰‡æ®µåŒ–ã€è¡¨æ ¼ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ tree_utils.py          # æ ‘ç»“æ„æ„å»ºå’Œå¯è§†åŒ–
â”‚   â”œâ”€â”€ dual_target_utils.py   # åŒé¶ç‚¹åˆ†æå’Œç‰‡æ®µåŒ¹é…
â”‚   â”œâ”€â”€ grid_pos_utils.py      # 3D ç©ºé—´ä½ç½®åˆ†æå’Œç½‘æ ¼åŒ–
â”‚   â””â”€â”€ common_utils.py        # é€šç”¨å·¥å…·å‡½æ•°ï¼ˆåˆ†å­å¤„ç†ã€Excel å¯¼å‡ºï¼‰
â”œâ”€â”€ scripts/                    # è¾…åŠ©è„šæœ¬
â”‚   â”œâ”€â”€ extract_sdf_fromMaegz.py    # ä» SchrÃ¶dinger å¯¹æ¥ç»“æœæå– SDF
â”‚   â””â”€â”€ BindingDB_processing.ipynb   # BindingDB æ•°æ®å¤„ç†
â”œâ”€â”€ CDK1-2/                     # æ¡ˆä¾‹ç ”ç©¶ï¼šCDK æŠ‘åˆ¶å‰‚
â”‚   â”œâ”€â”€ Create_tree_AIXB7.ipynb
â”‚   â”œâ”€â”€ fragmentize_CDK2.ipynb
â”‚   â””â”€â”€ CDK2_SMILES/           # åŒ…å«å®Œæ•´çš„ç‰‡æ®µåŒ–ç»“æœå’Œ SAR è¡¨æ ¼
â”œâ”€â”€ create_tree.ipynb           # Jupyter ç¤ºä¾‹ï¼šTLR7/8 æ ‘çŠ¶å›¾ç”Ÿæˆ
â”œâ”€â”€ print_sar.ipynb             # Jupyter ç¤ºä¾‹ï¼šSAR è¡¨æ ¼ç”Ÿæˆ
â””â”€â”€ test_functions.ipynb        # åŠŸèƒ½æµ‹è¯•
```

---

## ğŸ”§ å®‰è£…ä¾èµ–

### ç³»ç»Ÿè¦æ±‚

- Python 3.7+
- Linux/macOS/Windows

### æ ¸å¿ƒä¾èµ–

```bash
# åŒ–å­¦ä¿¡æ¯å­¦æ ¸å¿ƒåº“
rdkit>=2020.09
```

### æ•°æ®å¤„ç†å’Œå¯è§†åŒ–

```bash
# æ•°æ®å¤„ç†
pandas>=1.0.0
numpy>=1.18.0

# å¹¶è¡Œè®¡ç®—
pandarallel>=1.5.0

# å¯è§†åŒ–
matplotlib>=3.0.0
seaborn>=0.10.0
plotly>=4.0.0

# Excel æ”¯æŒ
openpyxl>=3.0.0

# å›¾å½¢ç”Ÿæˆ
graphviz>=0.14.0  # éœ€è¦ç³»ç»Ÿçº§ Graphviz
svglib>=1.0.0
reportlab>=3.5.0
IPython
pip install graphviz
micromamba install graphviz
# åˆ†å­å¯è§†åŒ–ï¼ˆç”¨äº 3D ç©ºé—´åˆ†æï¼‰
pymol-open-source>=2.5.0  # å¯é€‰ï¼Œç”¨äº 3D ç½‘æ ¼å¯è§†åŒ–
```

### SchrÃ¶dinger å¥—ä»¶ï¼ˆå¯é€‰ï¼‰

ç”¨äºå¯¹æ¥ç»“æœå¤„ç†ï¼š
```bash
# éœ€è¦å®‰è£… SchrÃ¶dinger Suiteï¼ˆ2021-2 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰
# ç”¨äºä» maegz æ–‡ä»¶æå– SDF ç»“æ„
```

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**

```bash
git clone git@github.com:SongyouZhong/autoSARM.git
cd autoSARM
```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**ï¼ˆæ¨èï¼‰

```bash
conda create -n autosarm python=3.8
conda activate autosarm
```

3. **å®‰è£… RDKit**

```bash
conda install -c conda-forge rdkit
```

4. **å®‰è£…å…¶ä»–ä¾èµ–**

```bash
pip install pandas numpy pandarallel matplotlib seaborn plotly openpyxl svglib reportlab
```

5. **å®‰è£… Graphviz**ï¼ˆç”¨äºæ ‘çŠ¶å›¾ç”Ÿæˆï¼‰

```bash
# Ubuntu/Debian
sudo apt-get install graphviz

# macOS
brew install graphviz

# Windows
# ä» https://graphviz.org/download/ ä¸‹è½½å®‰è£…
```

```bash
pip install graphviz
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¤ºä¾‹ 1ï¼šç”Ÿæˆ SAR è¡¨æ ¼

å‡†å¤‡è¾“å…¥æ–‡ä»¶ `compounds.csv`ï¼š

```csv
smiles,IC50_uM,Selectivity
Cc1ccc(C2CCN(C(=O)c3ccccc3)CC2)cc1,0.15,10.5
Cc1ccc(C2CCN(C(=O)c3cccc(F)c3)CC2)cc1,0.08,15.2
...
```

è¿è¡Œå‘½ä»¤ï¼š

```bash
python create_sarm.py \
    --csvFile compounds.csv \
    --column IC50_uM Selectivity \
    --type smiles \
    --log 1 \
    --minimumSite1 3 \
    --minimumSite2 3 \
    --n_jobs 8 \
    --save_folder SAR_Results \
    --csv2excel 1

python create_sarm.py \
  --csvFile SAR_Results/input.csv \
  --column IC50_uM \
  --type smiles \
  --log 1 \
  --minimumSite1 3 \
  --minimumSite2 3 \
  --n_jobs 8 \
  --save_folder SAR_Results_new \
  --csv2excel 1
```

**è¾“å‡ºæ–‡ä»¶**ï¼š
- `SAR_Results/Combine_Table_info.csv` - ä¸»è¡¨ä¿¡æ¯
- `SAR_Results/Combine_Table/` - å®Œæ•´çš„ 2D SAR è¡¨æ ¼
- `SAR_Results/Left_Table/` - å·¦ä¾§å–ä»£åŸºè¡¨æ ¼
- `SAR_Results/Right_Table/` - å³ä¾§å–ä»£åŸºè¡¨æ ¼

### ç¤ºä¾‹ 2ï¼šç”Ÿæˆ SAR æ ‘

```bash
python create_tree.py \
    --fragment_core "*CN1CCC(c2ccc3[nH]c(-c4cc(CO*)c5ncnn5c4)c(C(C)C)c3c2)CC1" \
    --rootTitle "Table_100_combine" \
    --workFolder ./SAR_Results \
    --maxLevel 5 \
    --treeContent "['double-cut','single-cut']" \
    --highlightDict "[{'col':'IC50_uM', 'type':'means', 'relation':'<', 'value':1.0}]"
```

**è¾“å‡º**ï¼š
- PDF æ ‘çŠ¶å›¾
- åˆ†å­ç»“æ„å›¾ç‰‡
- æ–‡æœ¬æ ¼å¼çš„æ ‘ç»“æ„

### ç¤ºä¾‹ 3ï¼šåŸºäºæ ¸å¿ƒç»“æ„çš„ SAR åˆ†æ

```bash
python print_sar_single_core.py \
    --csvFile compounds.csv \
    --core "c1ccc2[nH]c(-c3cc(CO)c4ncnn4c3)c(C(C)C)c2c1" \
    --actCols IC50_uM Selectivity \
    --n_jobs 8 \
    --save_folder Core_SAR_Results
```

**è¾“å‡º**ï¼š
- æ ¸å¿ƒç»“æ„ä¿¡æ¯è¡¨
- æ‰€æœ‰ R åŸºå›¢æšä¸¾
- å¸¦æ´»æ€§æ•°æ®çš„ Excel æŠ¥å‘Š

### ç¤ºä¾‹ 4ï¼š3D å¯¹æ¥ç»“æœåˆ†æï¼ˆå¯é€‰åŠŸèƒ½ï¼‰

**ä» SchrÃ¶dinger å¯¹æ¥ç»“æœæå– SDF**ï¼š

```bash
python scripts/extract_sdf_fromMaegz.py \
    --maegz docking_results.maegz \
    --saveDir ./sdf_output \
    --scoreLimit 6.0 \
    --format sd
```

**å‚æ•°è¯´æ˜**ï¼š
- `--maegz`: SchrÃ¶dinger å¯¹æ¥è¾“å‡ºæ–‡ä»¶
- `--scoreLimit`: æœ€å°å¯¹æ¥è¯„åˆ†ï¼ˆé»˜è®¤ 6.0ï¼‰
- `--format`: è¾“å‡ºæ ¼å¼ï¼ˆ`sd` æˆ– `mol2`ï¼‰

**åŸå­ä½ç½®ç½‘æ ¼åŒ–åˆ†æ**ï¼š

```python
from utils.grid_pos_utils import extract_sdf, grid_atom, create_grid_pse

# æå– SDF æ–‡ä»¶
extract_sdf('docking.maegz', './sdf_output', scoreLimit=6.0)

# ç½‘æ ¼åŒ–åˆ†æ
df_atmCount, grid_params = grid_atom('./sdf_output')

# ç”Ÿæˆ PyMOL å¯è§†åŒ–
create_grid_pse('atom_count.csv', 'output.pse', group='atomDensity')
```

---

## ğŸ“– ä½¿ç”¨è¯´æ˜

### å‚æ•°è¯´æ˜

#### `create_sarm.py` å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--csvFile` | è¾“å…¥ CSV æ–‡ä»¶è·¯å¾„ï¼ˆå¿…éœ€åŒ…å« smiles åˆ—ï¼‰ | å¿…éœ€ |
| `--type` | åˆ†å­ç±»å‹ï¼š`smiles` æˆ– `scaffold` | `smiles` |
| `--column` | æ´»æ€§æ•°æ®åˆ—åï¼ˆå¯å¤šä¸ªï¼‰ | å¿…éœ€ |
| `--log` | æ˜¯å¦å¯¹æ´»æ€§å€¼å–å¯¹æ•°ï¼ˆ0/1ï¼‰ | 0 |
| `--minimumSite1` | ç¬¬ä¸€è½®ç‰‡æ®µæœ€å°å‡ºç°æ¬¡æ•° | 3 |
| `--minimumSite2` | ç¬¬äºŒè½®ç‰‡æ®µæœ€å°å‡ºç°æ¬¡æ•° | 3 |
| `--n_jobs` | å¹¶è¡Œè®¡ç®—æ ¸å¿ƒæ•° | 8 |
| `--save_folder` | è¾“å‡ºæ–‡ä»¶å¤¹ | `SAR_Tables` |
| `--csv2excel` | æ˜¯å¦ç”Ÿæˆ Excelï¼ˆ0/1ï¼‰ | 0 |

#### `create_tree.py` å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--fragment_core` | æ ¸å¿ƒç‰‡æ®µ SMILESï¼ˆå¸¦ * æ ‡è®°ï¼‰ | å¿…éœ€ |
| `--rootTitle` | æ ‘çš„æ ¹èŠ‚ç‚¹æ ‡é¢˜ | å¿…éœ€ |
| `--workFolder` | SAR ç»“æœæ–‡ä»¶å¤¹ | å¿…éœ€ |
| `--maxLevel` | æœ€å¤§å±‚çº§ | 5 |
| `--treeContent` | æ ‘å†…å®¹ç±»å‹åˆ—è¡¨ | `['double-cut']` |
| `--highlightDict` | é«˜äº®æ¡ä»¶ï¼ˆJSON æ ¼å¼ï¼‰ | `''` |

#### `print_sar_single_core.py` å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--csvFile` | è¾“å…¥ CSV æ–‡ä»¶è·¯å¾„ | å¿…éœ€ |
| `--core` | æ ¸å¿ƒç»“æ„ SMILES | å¿…éœ€ |
| `--actCols` | æ´»æ€§æ•°æ®åˆ—åï¼ˆå¯å¤šä¸ªï¼‰ | `['ITK','JAK3','selectivity']` |
| `--n_jobs` | å¹¶è¡Œè®¡ç®—æ ¸å¿ƒæ•° | 8 |
| `--save_folder` | è¾“å‡ºæ–‡ä»¶å¤¹ | `Core_SAR` |

#### `extract_sdf_fromMaegz.py` å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--maegz` | SchrÃ¶dinger å¯¹æ¥ç»“æœæ–‡ä»¶ | å¿…éœ€ |
| `--saveDir` | SDF è¾“å‡ºæ–‡ä»¶å¤¹ | å¿…éœ€ |
| `--scoreLimit` | æœ€å°å¯¹æ¥è¯„åˆ† | 6.0 |
| `--format` | è¾“å‡ºæ ¼å¼ï¼ˆ`sd` æˆ– `mol2`ï¼‰ | `sd` |

### è¾“å…¥æ•°æ®æ ¼å¼

CSV æ–‡ä»¶å¿…é¡»åŒ…å«ä»¥ä¸‹åˆ—ï¼š
- `smiles`ï¼šSMILES æ ¼å¼çš„åˆ†å­ç»“æ„
- æ´»æ€§æ•°æ®åˆ—ï¼šå¦‚ `IC50_uM`, `Ki_nM`, `Selectivity` ç­‰

ç¤ºä¾‹ï¼š
```csv
smiles,IC50_JAK1,IC50_JAK2,Selectivity
Cc1ccc(C2CCN(C(=O)c3ccccc3)CC2)cc1,12.5,125,10.0
Cc1ccc(C2CCN(C(=O)c3cccc(F)c3)CC2)cc1,8.3,150,18.1
```

---

## ğŸ“ åº”ç”¨åœºæ™¯

### 1. è¯ç‰©å‘ç°

- **å…ˆå¯¼åŒ–åˆç‰©ä¼˜åŒ–**ï¼šå¿«é€Ÿè¯†åˆ«å…³é”®è¯æ•ˆå›¢
- **SAR æ¨¡å¼åˆ†æ**ï¼šå‘ç°æ´»æ€§æ‚¬å´–å’Œæ´»æ€§çƒ­ç‚¹
- **ç³»åˆ—åŒ–åˆç‰©è¯„ä¼°**ï¼šæ‰¹é‡åˆ†æä¸“åˆ©/æ–‡çŒ®åŒ–åˆç‰©

### 2. æ¿€é…¶æŠ‘åˆ¶å‰‚è®¾è®¡

æœ¬é¡¹ç›®ç‰¹åˆ«é€‚ç”¨äºï¼š
- **JAK æ¿€é…¶æŠ‘åˆ¶å‰‚**ï¼ˆJAK1/JAK2/JAK3ï¼‰- å¤šé¶ç‚¹é€‰æ‹©æ€§ä¼˜åŒ–
- **TLR æŠ‘åˆ¶å‰‚**ï¼ˆTLR7/TLR8ï¼‰- åŒ…å«å®Œæ•´ç¤ºä¾‹å’Œæ ‘çŠ¶å›¾åˆ†æ
- **ITK æŠ‘åˆ¶å‰‚** - é’ˆå¯¹ ITK/JAK3 é€‰æ‹©æ€§åˆ†æ
- **CDK æŠ‘åˆ¶å‰‚**ï¼ˆCDK1/CDK2ï¼‰- åŒ…å«å®Œæ•´æ¡ˆä¾‹ç ”ç©¶
- å…¶ä»–æ¿€é…¶é¶ç‚¹

### 3. å¤šé¶ç‚¹é€‰æ‹©æ€§åˆ†æ

- åŒé¶ç‚¹é€‰æ‹©æ€§æ¯”å€¼è®¡ç®—
- å¤šé¶ç‚¹æ´»æ€§å¯è§†åŒ–
- é€‰æ‹©æ€§ä¼˜åŒ–æŒ‡å¯¼

### 4. ä¸“åˆ©åˆ†æ

- ç«äº‰å¯¹æ‰‹åŒ–åˆç‰©ç³»åˆ—åˆ†æ
- ä¸“åˆ©æƒåˆ©è¦æ±‚è¦†ç›–èŒƒå›´è¯„ä¼°
- FTOï¼ˆFreedom to Operateï¼‰åˆ†æ

### 5. æ•°æ®åº“æŒ–æ˜

- BindingDBã€ChEMBL ç­‰å…¬å¼€æ•°æ®åº“å¤„ç†
- æ–‡çŒ®åŒ–åˆç‰©æ‰¹é‡æå–
- å†å²æ•°æ®å†åˆ†æ

---

## ğŸ“Š ç¤ºä¾‹

### CDK2 æŠ‘åˆ¶å‰‚æ¡ˆä¾‹

é¡¹ç›®åŒ…å«å®Œæ•´çš„ CDK2 æŠ‘åˆ¶å‰‚åˆ†ææ¡ˆä¾‹ï¼ˆ`CDK1-2/` æ–‡ä»¶å¤¹ï¼‰ï¼š

1. **æ•°æ®å‡†å¤‡**ï¼šä» BindingDB æå– CDK2 æŠ‘åˆ¶å‰‚æ•°æ®
2. **ç‰‡æ®µåŒ–**ï¼šç”Ÿæˆ 1000+ ä¸ªç‰‡æ®µ
3. **SAR è¡¨æ ¼**ï¼šç”Ÿæˆ 100+ ä¸ª 2D SAR çŸ©é˜µ
4. **æ ‘çŠ¶å›¾**ï¼šå¯è§†åŒ–åˆ†å­è¡ç”Ÿå…³ç³»

### è¾“å‡ºç¤ºä¾‹

**SAR è¡¨æ ¼ç¤ºä¾‹**ï¼š

```
        | R1: -CH3  | R1: -CH2CH3 | R1: -CF3
--------|-----------|-------------|----------
R2: -H  |   12.5    |    8.3      |   15.2
R2: -F  |   3.4     |    1.8      |   4.7
R2: -Cl |   5.6     |    2.9      |   6.8
```

æ¯ä¸ªå•å…ƒæ ¼åŒ…å«ï¼š
- åŒ–åˆç‰©ç»“æ„å›¾
- æ´»æ€§ç»Ÿè®¡ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ã€ä¸­ä½æ•°ï¼‰
- æ ·æœ¬æ•°é‡

---

## ğŸ”¬ æŠ€æœ¯ç‰¹ç‚¹

### åŒ–å­¦ä¿¡æ¯å­¦ç®—æ³•

1. **åˆ†å­ç‰‡æ®µåŒ–**
   - åŸºäºç¯ç³»ç»Ÿé™„è¿‘å•é”®çš„æ™ºèƒ½åˆ‡å‰²
   - ç¯-ç¯ä¹‹é—´å•é”®åˆ‡å‰²ï¼ˆå¯é€‰ï¼‰
   - éç¯å•é”®åˆ‡å‰²ï¼ˆå¯é€‰ï¼‰
   - ç¯ç³»ç»Ÿä¿æŠ¤
   - èŠ³é¦™æ€§ä¿æŒ
   - åŒä½ç´ æ ‡è®°å»é™¤

2. **ç›¸ä¼¼æ€§è®¡ç®—**
   - Morgan æŒ‡çº¹ï¼ˆECFP4ï¼Œradius=2ï¼‰
   - Tanimoto ç›¸ä¼¼åº¦
   - åŸºäºç›¸ä¼¼æ€§çš„è‡ªåŠ¨æ’åº
   - æ™ºèƒ½åˆ†å­èšç±»

3. **å­ç»“æ„åŒ¹é…**
   - SMARTS æ¨¡å¼åŒ¹é…
   - ç²¾ç¡®ç¯ç³»ç»ŸåŒ¹é…
   - æœ€å¤§å…¬å…±å­ç»“æ„ï¼ˆMCSï¼‰
   - æ ¸å¿ƒç»“æ„è¯†åˆ«
   - ç¦»å­åŒ–çŠ¶æ€å®¹é”™

4. **3D ç©ºé—´åˆ†æ**
   - åŸå­åæ ‡æå–å’Œå¤„ç†
   - 3D ç½‘æ ¼åˆ’åˆ†ï¼ˆå¯è‡ªå®šä¹‰å•å…ƒæ ¼å¤§å°ï¼‰
   - åŸå­å¯†åº¦ç»Ÿè®¡ï¼ˆæŒ‰ç±»å‹å’ŒèŠ³é¦™æ€§ï¼‰
   - ç‰‡æ®µç©ºé—´å æ®è¯„åˆ†

### æ€§èƒ½ä¼˜åŒ–

- **å¹¶è¡Œè®¡ç®—**ï¼šåŸºäº `pandarallel` çš„å¤šæ ¸å¹¶è¡Œ
- **å†…å­˜ä¼˜åŒ–**ï¼šåˆ†å—å¤„ç†å¤§æ•°æ®é›†
- **ç¼“å­˜æœºåˆ¶**ï¼šé¿å…é‡å¤è®¡ç®—

### å¯æ‰©å±•æ€§

- **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ ¸å¿ƒç®—æ³•ä¸åº”ç”¨åˆ†ç¦»
- **è‡ªå®šä¹‰æ’ä»¶**ï¼šæ”¯æŒè‡ªå®šä¹‰ç‰‡æ®µåŒ–è§„åˆ™
- **API æ¥å£**ï¼šå¯é›†æˆåˆ°å…¶ä»–å·¥ä½œæµ

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

### å¦‚ä½•è´¡çŒ®

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### æŠ¥å‘Šé—®é¢˜

è¯·åœ¨ [GitHub Issues](https://github.com/SongyouZhong/autoSARM/issues) ä¸­æŠ¥å‘Šé—®é¢˜ï¼Œå¹¶æä¾›ï¼š
- é—®é¢˜æè¿°
- é‡ç°æ­¥éª¤
- æœŸæœ›ç»“æœ
- å®é™…ç»“æœ
- ç¯å¢ƒä¿¡æ¯ï¼ˆPython ç‰ˆæœ¬ã€æ“ä½œç³»ç»Ÿç­‰ï¼‰

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ‘¥ ä½œè€…

**SongyouZhong**

- GitHub: [@SongyouZhong](https://github.com/SongyouZhong)

---

## ğŸ™ è‡´è°¢

- [RDKit](https://www.rdkit.org/) - åŒ–å­¦ä¿¡æ¯å­¦æ ¸å¿ƒåº“
- [Graphviz](https://graphviz.org/) - å›¾å½¢å¯è§†åŒ–
- [Pandas](https://pandas.pydata.org/) - æ•°æ®å¤„ç†

---

## ğŸ“š ç›¸å…³èµ„æº

- [RDKit æ–‡æ¡£](https://www.rdkit.org/docs/)
- [SMILES æ•™ç¨‹](https://www.daylight.com/dayhtml/doc/theory/theory.smiles.html)
- [è¯ç‰©åŒ–å­¦åŸºç¡€](https://en.wikipedia.org/wiki/Medicinal_chemistry)
- [æ„æ•ˆå…³ç³»åˆ†æ](https://en.wikipedia.org/wiki/Structure%E2%80%93activity_relationship)

---

## â“ å¸¸è§é—®é¢˜

### Q1: æ”¯æŒå“ªäº›è¾“å…¥æ ¼å¼ï¼Ÿ
A: ç›®å‰æ”¯æŒ CSV æ ¼å¼ï¼Œå¿…é¡»åŒ…å« SMILES åˆ—å’Œæ´»æ€§æ•°æ®åˆ—ã€‚

### Q2: å¯ä»¥åˆ†æå¤šå°‘ä¸ªåŒ–åˆç‰©ï¼Ÿ
A: ç†è®ºä¸Šæ— é™åˆ¶ï¼Œå»ºè®®å•æ¬¡åˆ†æ 1000-10000 ä¸ªåŒ–åˆç‰©ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚

### Q3: å¦‚ä½•å¤„ç†ç«‹ä½“åŒ–å­¦ï¼Ÿ
A: RDKit ä¼šä¿ç•™ç«‹ä½“åŒ–å­¦ä¿¡æ¯ï¼Œä½†ç‰‡æ®µåŒ–æ—¶å¯èƒ½ä¼šä¸¢å¤±ã€‚å»ºè®®é¢„å…ˆå¤„ç†ç«‹ä½“å¼‚æ„ä½“ã€‚

### Q4: æ”¯æŒ 3D ç»“æ„å—ï¼Ÿ
A: æ”¯æŒï¼é¡¹ç›®åŒ…å«å®Œæ•´çš„ 3D ç©ºé—´åˆ†ææ¨¡å—ï¼ˆ`grid_pos_utils.py`ï¼‰ï¼Œå¯ä»¥ï¼š
- å¤„ç† SchrÃ¶dinger å¯¹æ¥ç»“æœï¼ˆmaegz æ ¼å¼ï¼‰
- æå–å’Œåˆ†æåˆ†å­çš„ 3D åæ ‡
- è¿›è¡ŒåŸå­ä½ç½®ç½‘æ ¼åŒ–åˆ†æ
- è®¡ç®—ç‰‡æ®µåœ¨ç»“åˆå£è¢‹ä¸­çš„ç©ºé—´å æ®
- ç”Ÿæˆ PyMOL å¯è§†åŒ–

### Q5: å¦‚ä½•è‡ªå®šä¹‰ç‰‡æ®µåŒ–è§„åˆ™ï¼Ÿ
A: å¯ä»¥ä¿®æ”¹ `utils/sarm_utils.py` ä¸­çš„ `frag_mol_near_ring` å‡½æ•°ã€‚é€šè¿‡ `pos_args` å‚æ•°æ§åˆ¶ï¼š
- `{'RR':True, 'nRnR':False}`: åªåˆ‡å‰²ç¯æ—è¾¹çš„å•é”® + ç¯-ç¯ä¹‹é—´çš„å•é”®
- `{'RR':False, 'nRnR':True}`: åˆ‡å‰²æ‰€æœ‰éç¯å•é”®
- `{'RR':True, 'nRnR':True}`: ä¸¤è€…ç»“åˆ

### Q6: éœ€è¦ SchrÃ¶dinger è®¸å¯è¯å—ï¼Ÿ
A: ä»…å½“éœ€è¦å¤„ç†å¯¹æ¥ç»“æœæ—¶æ‰éœ€è¦ SchrÃ¶dinger Suiteã€‚æ ¸å¿ƒ SAR åˆ†æåŠŸèƒ½å®Œå…¨ç‹¬ç«‹ï¼Œä¸ä¾èµ–å•†ä¸šè½¯ä»¶ã€‚

### Q7: å¦‚ä½•å¤„ç†å¤šä¸ªå–ä»£ä½ç‚¹ï¼Ÿ
A: `print_sar_single_core.py` æ”¯æŒè‡ªåŠ¨è¯†åˆ«æ ¸å¿ƒç»“æ„ä¸Šçš„å¤šä¸ªè™šæ‹ŸåŸå­ï¼ˆdummy atomsï¼‰ï¼Œå¯ä»¥å¤„ç†åŒå–ä»£ã€ä¸‰å–ä»£ç­‰å¤æ‚æƒ…å†µã€‚

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–åˆä½œæ„å‘ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- ğŸ“§ Email: [é€šè¿‡ GitHub ä¸ªäººèµ„æ–™æŸ¥çœ‹]
- ğŸ’¬ GitHub Issues: [æäº¤é—®é¢˜](https://github.com/SongyouZhong/autoSARM/issues)
- ğŸŒŸ Star æœ¬é¡¹ç›®ä»¥è·å–æ›´æ–°

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Starï¼**

---

*æœ€åæ›´æ–°ï¼š2025å¹´11æœˆ13æ—¥*
